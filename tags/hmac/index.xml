<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>HMAC on My New Hugo Site</title>
    <link>https://asu1tty.github.io/tags/hmac/</link>
    <description>Recent content in HMAC on My New Hugo Site</description>
    <generator>Hugo</generator>
    <language>en</language>
    <lastBuildDate>Thu, 24 Apr 2025 11:45:36 +0800</lastBuildDate>
    <atom:link href="https://asu1tty.github.io/tags/hmac/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HMAC原理及代码实现</title>
      <link>https://asu1tty.github.io/post/mhac/</link>
      <pubDate>Thu, 24 Apr 2025 11:45:36 +0800</pubDate>
      <guid>https://asu1tty.github.io/post/mhac/</guid>
      <description>&lt;p&gt;HMAC（Hash-based Message Authentication Code，&lt;a href=&#34;https://so.csdn.net/so/search?q=%E6%95%A3%E5%88%97&amp;amp;spm=1001.2101.3001.7020&#34;&gt;散列&lt;/a&gt;消息认证码）是一种使用密码散列函数，同时结合一个加密密钥，通过特别计算方式之后产生的消息认证码（MAC）。&#xA;HMAC算法利用哈希运算，以一个密钥和一个消息为输入，生成一个消息摘要作为输出。&#xA;hmac算法通常需要以一个hash函数为载体,比如常见的有hmacMd5,hmacSha1,hmacSha256,目前在so里只见到过hmacMd5,hmacSha256,但是hmac的规则是适用所有hash函数的&lt;/p&gt;&#xA;&lt;p&gt;HMAC算法的数学公式为：&#xA;&lt;img src=&#34;https://wikimedia.org/api/rest_v1/media/math/render/svg/fb67423fa152e335f482c2a885c9f2bbed812e81&#34; alt=&#34;{\displaystyle {\textit {HMAC}}(K,m)=H{\Bigl (}(K’\oplus opad)\;||\;H{\bigl (}(K’\oplus ipad)\;||\;m{\bigr )}{\Bigr )}}&#34;&gt;&#xA;其中：&#xA;&lt;strong&gt;H&lt;/strong&gt; 为密码Hash函数（如MD5或SHA-2），能够对明文进行分组循环压缩；&#xA;&lt;strong&gt;k&lt;/strong&gt; 为密钥（secret key）；&#xA;&lt;strong&gt;m&lt;/strong&gt; 为要认证的消息；&#xA;&lt;strong&gt;k’&lt;/strong&gt; 是从原始密钥 k 导出的另一个密钥（如果 k 短于散列函数的输入块大小，则向右填充零；如果比该块大小更长，则对 k 进行散列）&#xA;&lt;strong&gt;ipad&lt;/strong&gt; 内部填充（0x5C5C5C…5C5C，一段十六进制常量）；&#xA;&lt;strong&gt;opad&lt;/strong&gt; 外部填充（0x363636…3636，一段十六进制常量）；&#xA;&lt;strong&gt;⊕&lt;/strong&gt;：按位异或运算。&#xA;&lt;strong&gt;||&lt;/strong&gt;：字符串拼接。&lt;/p&gt;&#xA;&lt;p&gt;总结8个字就是 &lt;strong&gt;两次加盐,两次hash&lt;/strong&gt;。&lt;/p&gt;&#xA;&lt;h2 id=&#34;1-算法实现过程&#34;&gt;&#xA;&lt;a class=&#34;header-anchor&#34; href=&#34;#1-%e7%ae%97%e6%b3%95%e5%ae%9e%e7%8e%b0%e8%bf%87%e7%a8%8b&#34;&gt;&lt;/a&gt;&#xA;1. 算法实现过程&#xA;&lt;/h2&gt;&lt;p&gt;HMAC需要选择一个哈希函数作为实现的载体，这里以MD5为例&lt;/p&gt;&#xA;&lt;h3 id=&#34;11-第一步扩展密钥&#34;&gt;&#xA;&lt;a class=&#34;header-anchor&#34; href=&#34;#11-%e7%ac%ac%e4%b8%80%e6%ad%a5%e6%89%a9%e5%b1%95%e5%af%86%e9%92%a5&#34;&gt;&lt;/a&gt;&#xA;1.1. 第一步：扩展密钥&#xA;&lt;/h3&gt;&lt;p&gt;以字符串&lt;code&gt;admin&lt;/code&gt;为例，十六进制如下&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;61 64 6D 69 6E&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;填充密钥到64字节&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;61 64 6D 69 6E 00(填充59次)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;12-异或0x36&#34;&gt;&#xA;&lt;a class=&#34;header-anchor&#34; href=&#34;#12-%e5%bc%82%e6%88%960x36&#34;&gt;&lt;/a&gt;&#xA;1.2. 异或0x36&#xA;&lt;/h3&gt;&lt;p&gt;将密钥逐字节异或0x36，得到&lt;strong&gt;扩展密钥1&lt;/strong&gt;，0x36十进制是54&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plaintext&#34; data-lang=&#34;plaintext&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;57 52 5b 5f 58 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36 36&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;13-异或0x54&#34;&gt;&#xA;&lt;a class=&#34;header-anchor&#34; href=&#34;#13-%e5%bc%82%e6%88%960x54&#34;&gt;&lt;/a&gt;&#xA;1.3. 异或0x54&#xA;&lt;/h3&gt;&lt;p&gt;将密钥逐字节异或0x54，得到&lt;strong&gt;扩展密钥2&lt;/strong&gt;，0x54十进制是92&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
